{"name":"sonos","type":"virtual_device","properties":{"deviceIcon":0,"currentIcon":"0","log":"","logTemp":"","mainLoop":"","visible":"true","rows":[{"type":"button","elements":[{"id":1,"lua":true,"waitForResponse":false,"caption":"Group","name":"Button11","empty":false,"msg":"-- ip 135 sẽ nhóm với group cua cua ten sôns\ntcpSocket = Net.FTcpSocket(\"192.168.1.135\", 1400)\ntensonos=\"RINCON_B8E937A2716A01400\"--RINCON_000E58DE2D0201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nContent-Length: 377\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#SetAVTransportURI\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:SetAVTransportURI xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID>,<CurrentURI>x-rincon:]]..tensonos..[[</CurrentURI>,<CurrentURIMetaData></CurrentURIMetaData></u:SetAVTransportURI></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\n\ntcpSocket:disconnect()\nfibaro:sleep(100);\ntcpSocket = Net.FTcpSocket(\"192.168.1.111\", 1400)\ntensonos=\"RINCON_B8E937A2716A01400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nContent-Length: 377\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#SetAVTransportURI\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:SetAVTransportURI xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID>,<CurrentURI>x-rincon:]]..tensonos..[[</CurrentURI>,<CurrentURIMetaData></CurrentURIMetaData></u:SetAVTransportURI></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\n--if errorcode == 0 then\n\t--state, errorcode = tcpSocket:read()\n\t--local TransportState = state:match(\"<CurrentTransportState>(.+)</CurrentTransportState>\")\n\t--fibaro:debug (TransportState)\n  \t--fibaro:log(TransportState)\n--end\ntcpSocket:disconnect()\n","buttonIcon":0,"favourite":false,"main":true}]},{"type":"button","elements":[{"id":2,"lua":true,"waitForResponse":false,"caption":"ungroup","name":"Button21","empty":false,"msg":"--THOÁT NHÓM IP SẼROUP THOÁT KHỎI g\ntcpSocket = Net.FTcpSocket(\"192.168.1.127\", 1400)\ntensonos=\"RINCON_000E58DE2D0201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nContent-Length: 310\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#BecomeCoordinatorOfStandaloneGroup\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:BecomeCoordinatorOfStandaloneGroup xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID></u:BecomeCoordinatorOfStandaloneGroup></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\nif errorcode == 0 then\n\tstate, errorcode = tcpSocket:read()\n\t--local TransportState = state:match(\"<CurrentTransportState>(.+)</CurrentTransportState>\")\n\t--fibaro:debug (TransportState)\n  \t--fibaro:log(TransportState)\nend\ntcpSocket:disconnect()\n--[tcpSocket = Net.FTcpSocket(\"192.168.1.127\", 1400)\ntensonos=\"RINCON_B8E9378D8E9201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nContent-Length: 377\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#SetAVTransportURI\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:SetAVTransportURI xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID>,<CurrentURI>x-rincon:]]..tensonos..[[</CurrentURI>,<CurrentURIMetaData></CurrentURIMetaData></u:SetAVTransportURI></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\n--bytes, errorcode = tcpSocket:write(payload)\n--fibaro:debug(bytes)\n--if errorcode == 0 then\n--\tstate, errorcode = tcpSocket:read()\n\t--local TransportState = state:match(\"<CurrentTransportState>(.+)</CurrentTransportState>\")\n\t--fibaro:debug (TransportState)\n  \t--fibaro:log(TransportState)\n--end\n--tcpSocket:disconnect()\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":3,"lua":true,"waitForResponse":false,"caption":"Add queue","name":"Button31","empty":false,"msg":"--THOÁT NHÓM IP SẼROUP THOÁT KHỎI g\ntcpSocket = Net.FTcpSocket(\"192.168.1.131\", 1400)\ntensonos=\"RINCON_000E58DE2D0201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nCONNECTION: close\nACCEPT-ENCODING: gzip\nHOST: 10.0.1.2:1400\nUSER-AGENT: Linux UPnP/1.0 Sonos/19.4-59140 (MDCR_MacBookPro6,2)\nCONTENT-LENGTH: 1246\nCONTENT-TYPE: text/xml; charset=\"utf-8\"\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#AddURIToQueue\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:AddURIToQueue xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID><EnqueuedURI>x-rincon-cpcontainer:1006006cspotify%3auser%3adavejunk1%3aplaylist%3a1OzDDLJ98nincl2cbREWiT</EnqueuedURI><EnqueuedURIMetaData><DIDL-Lite xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:upnp=\"urn:schemas-upnp-org:metadata-1-0/upnp/\" xmlns:r=\"urn:schemas-rinconnetworks-com:metadata-1-0/\" xmlns=\"urn:schemas-upnp-org:metadata-1-0/DIDL-Lite/\"><item id=\"1006006cspotify%3auser%3adavejunk1%3aplaylist%3a1OzDDLJ98nincl2cbREWiT\" parentID=\"100a0064playlists\" restricted=\"true\"><dc:title>Electrofunkish Soul</dc:title><upnp:class>object.container.playlistContainer</upnp:class><desc id=\"cdudn\" nameSpace=\"urn:schemas-rinconnetworks-com:metadata-1-0/\">SA_RINCON3079_davejunk1</desc></item></DIDL-Lite></EnqueuedURIMetaData><DesiredFirstTrackNumberEnqueued>0</DesiredFirstTrackNumberEnqueued><EnqueueAsNext>0</EnqueueAsNext></u:AddURIToQueue></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":4,"lua":true,"waitForResponse":false,"caption":"Clear Queue","name":"Button41","empty":false,"msg":"--THOÁT NHÓM IP SẼROUP THOÁT KHỎI g\ntcpSocket = Net.FTcpSocket(\"192.168.1.131\", 1400)\ntensonos=\"RINCON_000E58DE2D0201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nCONNECTION: close\nACCEPT-ENCODING: gzip\nHOST: 10.0.1.2:1400\nUSER-AGENT: Linux UPnP/1.0 Sonos/19.4-59140 (MDCR_MacBookPro6,2)\nCONTENT-LENGTH: 290\nCONTENT-TYPE: text/xml; charset=\"utf-8\"\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#RemoveAllTracksFromQueue\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:RemoveAllTracksFromQueue xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID></u:RemoveAllTracksFromQueue></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"button","elements":[{"id":5,"lua":true,"waitForResponse":false,"caption":"Play","name":"Button51","empty":false,"msg":"--THOÁT NHÓM IP SẼROUP THOÁT KHỎI g\ntcpSocket = Net.FTcpSocket(\"192.168.1.131\", 1400)\ntensonos=\"RINCON_000E58DE2D0201400\"\npayload = [[POST /MediaRenderer/AVTransport/Control HTTP/1.1\nContent-Length: 266\nSOAPACTION: \"urn:schemas-upnp-org:service:AVTransport:1#Play\"\n\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:Play xmlns:u=\"urn:schemas-upnp-org:service:AVTransport:1\"><InstanceID>0</InstanceID><Speed>1</Speed></u:Play></s:Body></s:Envelope>0x0D0x0A0x0D0x0A]]\nbytes, errorcode = tcpSocket:write(payload)\nfibaro:debug(bytes)\n","buttonIcon":0,"favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}