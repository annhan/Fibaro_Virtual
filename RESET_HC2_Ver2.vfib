{"name":"RESET HC2 Ver2","type":"virtual_device","properties":{"deviceIcon":479,"currentIcon":"479","log":"","logTemp":"","mainLoop":"HC2 = Net.FHttp(\"127.0.0.1\", 11111)\nresponse, status, errorCode = HC2:GET(\"/api/diagnostics\")\nif errorCode == 0 then \n  jsonTable = json.decode(response)\n  local CPU0\n  local CPU1\n  local i=0\n  for name,thongsos in pairs(jsonTable.cpuLoad) do\n    for name1,thongsos1 in pairs(thongsos) do\n      if i==0 then\n        CPU0=thongsos1.nice\n        i=1\n      else\n        CPU1=thongsos1.nice\n        end\n      end\n\tend\n  local bien=jsonTable.memory.free\n  fibaro:debug(cpu);\n  fibaro:debug(\"Ram \"..bien)\n    if tonumber(bien)<5 then\n      \t\tHC2 = Net.FHttp(\"127.0.0.1\", 11111)\n\t\t\tresponse, status, errorCode = HC2:POST(\"/api/settings/reboot\", \"data=reset\") \n\n    end\n  local label=\"Label1\" --tên Label hiển thị\n\tlocal selfId = fibaro:getSelfId();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n  \tbien=bien..\"%\"\n\tfibaro:call(selfId, \"setProperty\", \"ui.\"..label..\".value\",bien);\n  fibaro:call(selfId, \"setProperty\", \"ui.Label2.value\",CPU0);\n  fibaro:call(selfId, \"setProperty\", \"ui.Label3.value\",CPU1);\n\telse \n  fibaro:debug(\"error\") \nend ","ui.Label1.value":"56%","ui.Label2.value":"176","ui.Label3.value":"314","visible":"true","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"RAM FREE : ","name":"Label1","favourite":false,"main":true}]},{"type":"label","elements":[{"id":2,"lua":false,"waitForResponse":false,"caption":"CPU 0","name":"Label2","favourite":false,"main":false}]},{"type":"label","elements":[{"id":3,"lua":false,"waitForResponse":false,"caption":"CPU 1","name":"Label3","favourite":false,"main":false}]},{"type":"button","elements":[{"id":4,"lua":true,"waitForResponse":false,"caption":"RESET","name":"Button11","empty":false,"msg":"HC2 = Net.FHttp(\"192.168.60.10\") \nHC2:setBasicAuthentication(\"admin\", \"admin\") \nresponse, status, errorCode = HC2:POST(\"/api/settings/reboot\", \"data=reset\") \nfibaro:debug(response)\nif errorCode == 0 then \n  fibaro:log(status) \nelse \n  fibaro:log(\"error\") \nend ","buttonIcon":0,"favourite":false,"main":true}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}